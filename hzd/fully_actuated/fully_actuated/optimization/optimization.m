%clear;
tic
%clear all
%% optimization bounds and settings
A = [];
b = [];
Aeq = []; % [zeros(1,15),1,zeros(1,6)];
beq = []; % dq1t
%% the pose of swing foot shuold be 0 at both beginning and the end. 



%%
options = optimoptions('fmincon',...
    'Display','iter',...
    'MaxFunEvals',100000,...
    'MaxIter',100000,...
    'TolCon',1e-5);

%Alpha_fully=[0.7, 0.7, 0.75, 0.75, 0.7, 0.7, 0.7,...
%             0.3,   0.31,   0.37,   0.4,   0.37,   0.31,   0.3,...
%            -0.4,-0.28,-0.16,0,  0.16,0.28,0.4,...
%             0,   0.13, 0.16, 0.17,0.16, 0.13, 0,...
%             0,   0,  0,0, 0,0,0];
theta_plus = -0.4092;
theta_minus = 0.4865;


Alpha_under=[-0.8092, -0.4073,  -0.734,  -0.734,  -0.734,  -0.734,  -0.734,...
             -1.2040, -1.3417, -1.2085, -1.2085, -1.2085, -1.2085, -1.2085,...
              1.0118,  1.0810,  0.8654,  0.8654,  0.8654,  0.8654,  0.8654,...
              1.6324,  1.3454,  1.2191,  0.85,    0.8,     0.7,     0.5236,...
             -0.5667, -0.4934, -0.4919, -0.4919, -0.4919, -0.4919, -0.4919,...
             -0.7924, -0.6422, -0.4712, -0.3712, -0.6712, -0.5712, -0.5712];

            % -1.2085, -1.2085, -1.2085, -1.2085, -1.2085, -1.2085, -1.2085,...
            % -0.734,  -0.734,  -0.734,  -0.734,  -0.734,  -0.734,  -0.734,...
            %  1.5191,  1.3191,  1.2191,  0.85,    0.8,     0.7,     0.5236,...
            %  0.8654,  0.8654,  0.8654,  0.8654,  0.8654,  0.8654,  0.8654,...
            % -0.6712, -0.5712, -0.4712, -0.3712, -0.2712,  0     ,  0, ...
            % -0.4919, -0.4919, -0.4919, -0.4919, -0.4919, -0.4919, -0.4919];
Alpha_over = [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7,...
              0.3,  0.31, 0.37, 0.4,  0.37,  0.31, 0.3,...
              0,    0.03, 0.05, 0.09, 0.12, 0.13, 0.2,...
              -0.13,  -0.13,  -0.13,  -0.13,  -0.04, -0.03, 0];

%Alpha=[Alpha_fully,Alpha_under(1,:),Alpha_over];
%Alpha = [Alpha_under,theta_plus,theta_minus];
load under_alpha.mat
Alpha = [optimized(1:42),theta_plus,theta_minus];
%Alpha = optimized;
ub=3*ones(44,1);
lb=-3*ones(44,1);

x0 = Alpha;
[Cost,Cnst] = opt_Obj_Cnst_V3_7;

[optimized,fval,exitflag,output] = fmincon(Cost,x0,A,b,Aeq,beq,...
    lb,ub,Cnst,options);


%save 'save_correct_upgraded_left.mat' optimized_alpha

toc